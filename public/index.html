<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HEAVY AUDIO TEST</title>
    <style>
        body { background-color: #000; color: #fff; text-align: center; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        button { padding: 20px 40px; font-size: 25px; font-weight: bold; background: #D32F2F; color: white; border: none; border-radius: 10px; cursor: pointer; margin-top: 20px; }
        #status { margin-top: 20px; font-size: 18px; color: yellow; border: 1px solid #333; padding: 10px; width: 90%; word-wrap: break-word; }
    </style>
</head>
<body>

    <h1>HEAVY TEST MODE</h1>
    <p>Î˜Î± Ï€Î±Î¯Î¾Î¿Ï…Î¼Îµ Ï„Î· Î£Î•Î™Î¡Î—ÎÎ‘ Î±Î½Ï„Î¯ Î³Î¹Î± ÏƒÎ¹Ï‰Ï€Î®.</p>
    <p>Î‘Î½ Î²Î³ÎµÎ¹ Î· Î¼Ï€Î¬ÏÎ±, Ï†Ï„Î±Î¯ÎµÎ¹ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ ÏƒÎ¹Ï‰Ï€Î®Ï‚.</p>

    <button onclick="startHeavyPlayer()">TEST SIREN ğŸš¨</button>

    <div id="status">Î‘Î½Î±Î¼Î¿Î½Î®...</div>

    <audio id="myAudio" src="alert.mp3" loop preload="auto"></audio>

    <script>
        function log(text) {
            const el = document.getElementById('status');
            el.innerHTML += "<br>" + text;
            console.log(text);
        }

        function startHeavyPlayer() {
            const audio = document.getElementById('myAudio');
            
            // ÎšÎ‘Î˜Î‘Î¡Î™Î£ÎœÎŸÎ£
            document.getElementById('status').innerHTML = "ÎÎµÎºÎ¹Î½Î¬Ï‰...";

            // 1. Î”ÎŸÎšÎ™ÎœÎ— PLAY
            audio.volume = 0.5; // Î§Î±Î¼Î·Î»Î¬ Î³Î¹Î± Î½Î± Î¼Î·Î½ ÎºÎ¿Ï…Ï†Î±Î¸ÎµÎ¯Ï‚
            
            const playPromise = audio.play();

            if (playPromise !== undefined) {
                playPromise.then(_ => {
                    log("âœ… 1. ÎŸ Î‰Ï‡Î¿Ï‚ Ï€Î±Î¯Î¶ÎµÎ¹!");

                    // 2. Î•ÎÎ•Î¡Î“ÎŸÎ ÎŸÎ™Î—Î£Î— MEDIA SESSION
                    if ('mediaSession' in navigator) {
                        navigator.mediaSession.playbackState = "playing";
                        navigator.mediaSession.metadata = new MediaMetadata({
                            title: "SIREN TEST",
                            artist: "Does Bar Appear?",
                            album: "Debug Mode",
                            artwork: [
                                { src: 'https://cdn-icons-png.flaticon.com/512/190/190411.png', sizes: '512x512', type: 'image/png' }
                            ]
                        });

                        // Î•ÎÎ•Î¡Î“ÎŸÎ ÎŸÎ™Î—Î£Î— ÎšÎŸÎ¥ÎœÎ Î™Î©Î
                        const actionHandlers = [
                            ['play',   () => { log("â–¶ï¸ Play pressed"); audio.play(); }],
                            ['pause',  () => { log("â¸ï¸ Pause pressed"); audio.pause(); }],
                            ['previoustrack', () => { log("â®ï¸ Prev pressed"); }],
                            ['nexttrack',     () => { log("â­ï¸ Next pressed"); }],
                            ['stop',          () => { log("â¹ï¸ Stop pressed"); }]
                        ];

                        for (const [action, handler] of actionHandlers) {
                            try {
                                navigator.mediaSession.setActionHandler(action, handler);
                            } catch (error) {
                                log(`âš ï¸ Fail handler ${action}: ${error.message}`);
                            }
                        }

                        log("âœ… 2. Media Session ÎµÏƒÏ„Î¬Î»Î·!");
                        log("ğŸ‘‰ ÎšÎŸÎ™Î¤Î‘ Î¤Î—Î ÎœÎ Î‘Î¡Î‘ Î¤Î©Î¡Î‘!");

                    } else {
                        log("âŒ Media Session Î”Î•Î Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÏ„Î±Î¹ ÏƒÎµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Browser.");
                    }
                })
                .catch(error => {
                    log("âŒ Î£Î¦Î‘Î›ÎœÎ‘ Play: " + error.message);
                    log("Î”Î¿ÎºÎ¯Î¼Î±ÏƒÎµ Î½Î± Ï€Î±Ï„Î®ÏƒÎµÎ¹Ï‚ Ï„Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯ Î¾Î±Î½Î¬.");
                });
            }
        }
    </script>
</body>
</html>
