<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BAR FIX TEST</title>
    <style>
        body { background-color: #000; color: #fff; text-align: center; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        button { padding: 20px 40px; font-size: 25px; font-weight: bold; background: #2962FF; color: white; border: none; border-radius: 10px; cursor: pointer; margin-top: 20px; }
        #status { margin-top: 20px; font-size: 18px; color: yellow; border: 1px solid #333; padding: 10px; width: 90%; word-wrap: break-word; }
        .instructions { font-size: 14px; color: #ccc; margin-top: 20px; text-align: left; width: 80%; }
    </style>
</head>
<body>

    <h1>BAR FIX MODE</h1>
    <p>Î ÏÎ¿ÏƒÎ¸Î­ÏƒÎ±Î¼Îµ "Î”Î¹Î¬ÏÎºÎµÎ¹Î±" ÏƒÏ„Î¿ Ï„ÏÎ±Î³Î¿ÏÎ´Î¹.</p>

    <button onclick="startBarTest()">TEST BAR ğŸµ</button>

    <div id="status">Î‘Î½Î±Î¼Î¿Î½Î®...</div>

    <audio id="myAudio" src="alert.mp3" loop preload="auto"></audio>

    <div class="instructions">
        <h3>âš ï¸ Î‘Î Î Î‘Î™Î–Î•Î™ Î‘Î›Î›Î‘ Î”Î•Î Î’Î›Î•Î Î•Î™Î£ ÎœÎ Î‘Î¡Î‘:</h3>
        1. Î£ÏÏÎµ Ï„Î¿ Î´Î¬Ï‡Ï„Ï…Î»Î¿ Î±Ï€ÏŒ Î Î‘ÎÎ© Ï€ÏÎ¿Ï‚ Ï„Î± ÎšÎ‘Î¤Î© (Status Bar).<br>
        2. Î‘Î½ Î´ÎµÎ½ ÎºÎ±Ï„ÎµÎ²Î±Î¯Î½ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î±, Ï†Ï„Î±Î¯ÎµÎ¹ Ï„Î¿ Fully Kiosk (Î­Ï‡ÎµÎ¹ ÎºÏÏÏˆÎµÎ¹ Ï„Î·Î½ Î¼Ï€Î¬ÏÎ±).
    </div>

    <script>
        function log(text) {
            const el = document.getElementById('status');
            el.innerHTML = text + "<br>" + el.innerHTML;
            console.log(text);
        }

        function startBarTest() {
            const audio = document.getElementById('myAudio');
            
            log("â³ ÎÎµÎºÎ¹Î½Î¬Ï‰...");

            // 1. PLAY
            audio.volume = 0.5;
            
            audio.play()
            .then(() => {
                log("âœ… Î‰Ï‡Î¿Ï‚ Ï€Î±Î¯Î¶ÎµÎ¹!");

                if ('mediaSession' in navigator) {
                    
                    // 2. METADATA (Î¤Î¯Ï„Î»Î¿Ï‚/Î•Î¹ÎºÏŒÎ½Î±)
                    navigator.mediaSession.metadata = new MediaMetadata({
                        title: "ELEGXOS BARAS",
                        artist: "Pata Pause/Next",
                        album: "System Test",
                        artwork: [
                            { src: 'https://cdn-icons-png.flaticon.com/512/190/190411.png', sizes: '96x96', type: 'image/png' },
                            { src: 'https://cdn-icons-png.flaticon.com/512/190/190411.png', sizes: '128x128', type: 'image/png' },
                            { src: 'https://cdn-icons-png.flaticon.com/512/190/190411.png', sizes: '512x512', type: 'image/png' }
                        ]
                    });

                    // 3. HANDLERS (ÎšÎ¿Ï…Î¼Ï€Î¹Î¬)
                    const dummy = () => log("ğŸ”˜ Î Î±Ï„Î®Î¸Î·ÎºÎµ ÎšÎ¿Ï…Î¼Ï€Î¯!");
                    navigator.mediaSession.setActionHandler('play', () => { log("â–¶ Play"); audio.play(); });
                    navigator.mediaSession.setActionHandler('pause', () => { log("â¸ Pause"); audio.pause(); });
                    navigator.mediaSession.setActionHandler('nexttrack', dummy);
                    navigator.mediaSession.setActionHandler('previoustrack', dummy);

                    // 4. ğŸ”¥ Î¤ÎŸ ÎœÎ¥Î£Î¤Î™ÎšÎŸ Î£Î¥Î£Î¤Î‘Î¤Î™ÎšÎŸ ğŸ”¥
                    // Î›Î­Î¼Îµ ÏƒÏ„Î¿ Android ÏŒÏ„Î¹ Ï„Î¿ Ï„ÏÎ±Î³Î¿ÏÎ´Î¹ Î­Ï‡ÎµÎ¹ Î¼ÎµÎ³Î¬Î»Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î±.
                    // Î§Ï‰ÏÎ¯Ï‚ Î±Ï…Ï„ÏŒ, Î¼ÎµÏÎ¹ÎºÎ¬ Android Î”Î•Î Î´ÎµÎ¯Ï‡Î½Î¿Ï…Î½ Ï„Î·Î½ Î¼Ï€Î¬ÏÎ±.
                    try {
                        navigator.mediaSession.setPositionState({
                            duration: 600,      // 10 Î›ÎµÏ€Ï„Î¬ Î´Î¹Î¬ÏÎºÎµÎ¹Î±
                            playbackRate: 1.0,
                            position: 10        // Î•Î¯Î¼Î±ÏƒÏ„Îµ ÏƒÏ„Î¿ 10Î¿ Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î¿
                        });
                        log("âœ… PositionState Set (Î”Î¹Î¬ÏÎºÎµÎ¹Î± OK)");
                    } catch(e) {
                        log("âš ï¸ PositionState Error: " + e.message);
                    }

                    // 5. Playback State
                    navigator.mediaSession.playbackState = "playing";

                    log("ğŸ‘‰ Î¤Î©Î¡Î‘ Î£Î¥Î¡Î• Î¤Î—Î ÎŸÎ˜ÎŸÎÎ— Î‘Î ÎŸ Î Î‘ÎÎ©!");

                } else {
                    log("âŒ MediaSession Not Supported");
                }
            })
            .catch(e => {
                log("âŒ Play Error: " + e.message);
            });
        }
    </script>
</body>
</html>
