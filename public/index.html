<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TEST PLAYER</title>
    <style>
        body { background-color: #000; color: #fff; text-align: center; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        button { padding: 20px 40px; font-size: 25px; font-weight: bold; background: #00E676; border: none; border-radius: 10px; cursor: pointer; margin-top: 20px; }
        input { padding: 10px; font-size: 18px; text-align: center; margin: 5px; width: 80%; background: #222; color: white; border: 1px solid #444; }
        h1 { color: red; }
    </style>
    
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-messaging.js"></script>
</head>
<body>

    <h1>TEST PLAYER MODE</h1>
    <p>Î£Ï…Î¼Ï€Î»Î®ÏÏ‰ÏƒÎµ ÎºÎ±Î¹ Ï€Î¬Ï„Î± Ï„Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯ Î³Î¹Î± Î½Î± Î´Î¿ÏÎ¼Îµ Ï„Î·Î½ Î¼Ï€Î¬ÏÎ±.</p>

    <input type="text" id="inpStore" placeholder="Store Name" value="CoffeeRoom1">
    <input type="text" id="inpName" placeholder="Name" value="Marios">
    <input type="password" id="inpPass" placeholder="Password" value="1234">

    <button onclick="startDryPlayer()">START PLAYER ğŸµ</button>

    <div id="status" style="margin-top:20px; color: yellow;">Î‘Î½Î±Î¼Î¿Î½Î®...</div>

    <audio id="silence" loop>
        <source src="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA//oeBkAAAAAAABIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//oeBkAAACQAABIAAAAAAAAEgAAAAAAAAAAAAAAqr///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AAA=" type="audio/mpeg">
    </audio>

    <script src="watchdog.js?v=99"></script>
    <script src="logic.js?v=99"></script>

    <script>
        // --- ÎŸ Î Î™ÎŸ Î‘Î Î›ÎŸÎ£ ÎšÎ©Î”Î™ÎšÎ‘Î£ Î“Î™Î‘ PLAYER ---
        function startDryPlayer() {
            const status = document.getElementById('status');
            const audio = document.getElementById('silence');

            status.innerText = "1. Î Î±Ï„Î¬Ï‰ Play...";

            // 1. Î Î‘Î™Î–ÎŸÎ¥ÎœÎ• Î¤ÎŸÎ Î—Î§ÎŸ
            audio.volume = 1.0;
            audio.play()
            .then(() => {
                status.innerText = "2. Î‰Ï‡Î¿Ï‚ ÎŸÎš! Î¦Ï„Î¹Î¬Ï‡Î½Ï‰ ÎœÏ€Î¬ÏÎ±...";
                
                // 2. Î¦Î¤Î™Î‘Î§ÎÎŸÎ¥ÎœÎ• Î¤Î—Î ÎœÎ Î‘Î¡Î‘ (Î§Î©Î¡Î™Î£ Î ÎŸÎ›Î›Î‘ Î›ÎŸÎ“Î™Î‘)
                if ('mediaSession' in navigator) {
                    navigator.mediaSession.playbackState = "playing";
                    navigator.mediaSession.metadata = new MediaMetadata({
                        title: "TEST SUCCESS",
                        artist: "Dry Player Mode",
                        album: "System Test",
                        artwork: [
                            { src: 'https://cdn-icons-png.flaticon.com/512/190/190411.png', sizes: '512x512', type: 'image/png' }
                        ]
                    });

                    // 3. Î’Î‘Î–ÎŸÎ¥ÎœÎ• Î¤Î‘ ÎšÎŸÎ¥ÎœÎ Î™Î‘ (Î‘Î Î‘Î¡Î‘Î™Î¤Î—Î¤ÎŸ Î“Î™Î‘ ANDROID)
                    const dummyHandler = () => { console.log('Button pressed'); };
                    navigator.mediaSession.setActionHandler('play', dummyHandler);
                    navigator.mediaSession.setActionHandler('pause', dummyHandler);
                    navigator.mediaSession.setActionHandler('stop', dummyHandler);
                    navigator.mediaSession.setActionHandler('nexttrack', dummyHandler);
                    navigator.mediaSession.setActionHandler('previoustrack', dummyHandler);
                    
                    status.innerText = "3. ÎœÏ€Î¬ÏÎ± ÎŸÎš! ÎœÏ€Î±Î¯Î½Ï‰...";
                } else {
                    status.innerText = "âŒ MediaSession not supported";
                }

                // 4. Î Î¡ÎŸÎ§Î©Î¡Î‘ÎœÎ• Î£Î¤ÎŸ LOGIN
                setTimeout(() => {
                    const store = document.getElementById('inpStore').value;
                    const name = document.getElementById('inpName').value;
                    const pass = document.getElementById('inpPass').value;
                    if(typeof Logic !== 'undefined') Logic.login(store, name, 'driver', pass);
                }, 500);

            })
            .catch(e => {
                status.innerText = "âŒ Error: " + e.message;
                alert("Î”ÎµÎ½ Î­Ï€Î±Î¹Î¾Îµ Î¿ Î®Ï‡Î¿Ï‚!");
            });
        }
    </script>
</body>
</html>
