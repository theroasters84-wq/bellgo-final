<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <!-- âœ… VIEWPORT: Î¤Î¿ ÎºÎ»ÎµÎ¹Î´Î¯ Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÎ±ÏÎ¼ÏŒÎ¶ÎµÏ„Î±Î¹ ÏƒÎµ ÎºÎ¬Î¸Îµ Î¿Î¸ÏŒÎ½Î· -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>BellGo Mini</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            margin: 0; padding: 0;
            background-color: #121212; color: white;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            height: 100dvh; /* Dynamic Viewport Height Î³Î¹Î± ÎºÎ¹Î½Î·Ï„Î¬ */
            display: flex; flex-direction: column;
            overflow: hidden;
        }

        /* ÎšÎµÎ½Ï„ÏÎ¹ÎºÏŒ Container Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÎ±ÏÎ¼ÏŒÎ¶ÎµÏ„Î±Î¹ */
        .app-container {
            flex: 1;
            width: 100%; 
            height: 100%;
            display: flex; flex-direction: column;
            position: relative;
            background: #1e1e1e;
            transition: max-width 0.3s ease;
        }

        /* Header Î¼Îµ Safe Area Î³Î¹Î± Notches (iPhone) */
        .header {
            padding: 15px;
            background: #222;
            text-align: center;
            font-weight: bold;
            border-bottom: 1px solid #333;
            padding-top: max(15px, env(safe-area-inset-top)); 
            color: #FFD700;
        }

        .content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center;
        }

        .device-badge {
            margin-top: 20px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            background: #333;
            color: #aaa;
        }

        .status-box {
            margin-top: 20px;
            font-size: 16px;
            font-weight: bold;
            min-height: 24px;
        }

        /* âœ… DESKTOP DETECTION: Î‘Î½ Î· Î¿Î¸ÏŒÎ½Î· ÎµÎ¯Î½Î±Î¹ Î¼ÎµÎ³Î¬Î»Î·, ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î­ÏÎµÏ„Î±Î¹ ÏƒÎ±Î½ App ÏƒÏ„Î¿ ÎºÎ­Î½Ï„ÏÎ¿ */
        @media (min-width: 769px) {
            .app-container {
                max-width: 400px; /* Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· ÏƒÎ±Î½ ÎºÎ¹Î½Î·Ï„ÏŒ ÏƒÏ„Î¿ Desktop */
                margin: 0 auto;
                border-left: 1px solid #333;
                border-right: 1px solid #333;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header">BellGo Mini</div>
        <div class="content">
            <h2>Mini App</h2>
            <p>Î— Î¿Î¸ÏŒÎ½Î· Ï€ÏÎ¿ÏƒÎ±ÏÎ¼ÏŒÏƒÏ„Î·ÎºÎµ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î±.</p>
            <!-- Î•Î´Ï Î¸Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Î¿ Ï„ÏÏ€Î¿Ï‚ ÏƒÏ…ÏƒÎºÎµÏ…Î®Ï‚ Î¼Î­ÏƒÏ‰ CSS/JS -->
            <div class="device-badge" id="deviceInfo">Î‘Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ·...</div>
            <div class="status-box" id="statusMsg"></div>
        </div>
    </div>

    <script>
        function detectDevice() {
            const width = window.innerWidth;
            const el = document.getElementById('deviceInfo');
            if (width > 768) {
                el.innerText = "ğŸ’» Desktop Mode";
                el.style.color = "#00E676";
            } else {
                el.innerText = "ğŸ“± Mobile Mode";
                el.style.color = "#FFD700";
            }
        }
        window.addEventListener('resize', detectDevice);
        detectDevice();

        // âœ… SOCKET LOGIC: Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÏŒÏ„Î±Î½ Î¿ Î´Î­ÎºÏ„Î·Ï‚ Î±Ï€Î¿Î´ÎµÏ‡Ï„ÎµÎ¯ Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ·
        const params = new URLSearchParams(window.location.search);
        const storeName = params.get('store');
        const myName = params.get('name') || 'MiniUser';

        if (storeName) {
            const socket = io();
            
            socket.on('connect', () => {
                // Î£ÏÎ½Î´ÎµÏƒÎ· ÏƒÏ„Î¿ ÎºÎ±Ï„Î¬ÏƒÏ„Î·Î¼Î± Î³Î¹Î± Î½Î± Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î¼Îµ events
                socket.emit('join-store', { 
                    storeName: storeName, 
                    username: myName, 
                    role: 'waiter', // Î¡ÏŒÎ»Î¿Ï‚ Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î»Î®ÏˆÎ· ÎµÎ¹Î´Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ‰Î½
                    isNative: false 
                });
            });

            // ğŸ‘‚ Î‘ÎšÎ¡ÎŸÎ‘Î£Î— Î‘Î ÎŸÎ”ÎŸÎ§Î—Î£ ÎšÎ›Î—Î£Î—Î£
            socket.on('staff-accepted-alarm', (data) => {
                const el = document.getElementById('statusMsg');
                el.innerText = `âœ… Î— ÎºÎ»Î®ÏƒÎ· Î­Î³Î¹Î½Îµ Î±Ï€Î¿Î´ÎµÎºÏ„Î® Î±Ï€ÏŒ: ${data.username}`;
                el.style.color = "#00E676";
                
                // ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ 5 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±
                setTimeout(() => { el.innerText = ""; }, 5000);
            });
        }
    </script>
</body>
</html>